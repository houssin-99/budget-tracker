<div class="luxury-bg"></div>
<div class="container py-5">

<router-outlet></router-outlet>

  <!-- HEADER -->
  <header class="text-center mb-5">
    <h1 class="display-4 fw-bold text-gradient">ğŸ Budget Tracker</h1>
    <p class="text-muted lead">Finance made beautiful & premium.</p>
  </header>

  <!-- BALANCE -->
  <div class="card balance-card shadow-lg p-4 text-center mx-auto">
    <h5>Current Balance</h5>
    <h2 class="fw-bold balance-amount" [class.positive]="balance >= 0" [class.negative]="balance < 0">
      â‚¬ {{ balance }}
    </h2>
  </div>

  <!-- FILTERS -->
  <div class="ios-filter">
    <button (click)="setFilter('all')" [class.active]="filter() === 'all'">All</button>
    <button (click)="setFilter('income')" [class.active]="filter() === 'income'">Income</button>
    <button (click)="setFilter('expense')" [class.active]="filter() === 'expense'">Expenses</button>
  </div>

  <!-- TRANSACTION FORM -->
  <div class="card glass-card p-4 mt-4 mx-auto">
    <div class="form-grid">
      <input class="lux-input" placeholder="Description" [(ngModel)]="draftDescription">
      <input class="lux-input" type="number" placeholder="Amount (â‚¬)" [(ngModel)]="draftAmount">
      <select class="lux-input" [(ngModel)]="draftType">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>
    </div>

    <button class="btn btn-lux add-btn" (click)="addTransaction()">
      + Add Transaction
    </button>
  </div>

  <!-- SECTION TITLE -->
  <h3 class="section-title mt-5">ğŸ¯ Saving Goals</h3>

  <!-- GOAL INPUT -->
  <div class="glass-card p-4" style="max-width:900px; margin:auto;">
    <div class="row g-3 mb-4">
      <div class="col-md-7">
        <input class="form-control lux-input" placeholder="Goal name (e.g., New Bike)" [(ngModel)]="draftGoalName">
      </div>

      <div class="col-md-3">
        <input type="number" class="form-control lux-input" placeholder="Target (â‚¬)" [(ngModel)]="draftGoalTarget">
      </div>

      <div class="col-md-2">
        <button class="btn-lux w-100" (click)="addGoal()">+ Add Goal</button>
      </div>
    </div>
  </div>

  <!-- GOAL CARDS (Angular 17 syntax) -->
  @for (goal of goals(); track goal.id) {
    <div class="glass-card p-3 mb-3">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <strong>{{ goal.name }}</strong><br>
          Target: â‚¬{{ goal.target }}
        </div>
        <button class="delete-btn" (click)="removeGoal(goal.id)">ğŸ—‘ï¸</button>
      </div>

      <!-- PROGRESS -->
      <div class="progress mt-3" style="height: 10px; border-radius: 10px; background: rgba(255,255,255,0.1);">
        <div class="progress-bar"
            role="progressbar"
            [style.width.%]="goalProgress(goal)"
            style="background:linear-gradient(90deg,#00ffc3,#2effd9);border-radius:10px;">
        </div>
      </div>

      <p class="mt-2" style="color:white;opacity:.8;">
        {{ goalProgress(goal) }}% complete (based on current balance)
      </p>
    </div>
  }

  <!-- TRANSACTIONS LIST -->
  <h3 class="section-title mt-5">ğŸ“Œ Recent Transactions</h3>
  <div class="transactions mt-3">
    @for (tx of getFilteredTransactions(); track tx.id) {
      <div class="transaction-card">
        <div class="tx-info">
          <div class="tx-title">{{ tx.description }}</div>
          <div class="tx-date">{{ tx.date }}</div>
          <span class="category-badge" [attr.data-category]="tx.category || 'Uncategorized'">
            {{ tx.category || 'Uncategorized' }}
          </span>
        </div>

        <div class="tx-amount" [class.income]="tx.type === 'income'" [class.expense]="tx.type === 'expense'">
          {{ tx.type === 'income' ? '+' : '-' }}â‚¬{{ tx.amount }}
        </div>

        <button class="delete-btn" (click)="removeTransaction(tx.id)">ğŸ—‘ï¸</button>
      </div>
    }
  </div>

  <!-- BALANCE CHART -->
  <h3 class="section-title mt-5">ğŸ“Š Balance Trend</h3>
  <div class="chart-card glass-card p-4 mb-5">
    <canvas id="balanceChart"></canvas>
  </div>

</div>
